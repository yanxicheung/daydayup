记录系统程序员成长计划一书学习过程。





封装

**隔离变化。**程序的隐私通常是程序最容易变化的部分，比如内部数据结构，内部使用的函 

数和全局变量等等，把这些代码封装起来，它们的变化不会影响系统的其它部分。

**降低复杂度。**接口最小化是软件设计的基本原则之一，最小化接口容易被理解和使用。封 

装内部实现细节，只暴露最小的接口，会让系统变得简单明了，在一定程度上降低了系统的复杂度。

如何封装

暴露内部数据结构，会使头文件看起来杂乱无章，让调用者发蒙。其次是如果调用者图方便， 

直接访问这些数据结构的成员，会造成模块之间紧密耦合，给以 后的修改带来困难。隐藏

数据结构的方法很简单，如果是内部数据结构，外面完全不会引用，则直接放在 C 文件中就

好了，千万不要放在头文件里。如果该数据结构 在内外都要使用，则可以对外暴露结构的 

名字。



隐藏内部函数的做法

在头文件中，只放最小接口函数的声明。

在 C 文件上，所有内部函数都加上 static 关键字。

函数指针是实现多态的手段，多态就是隔离变化的秘诀。



gcc 链接共享库的方式：-L 用来指 定共享库所在目

录，系统库目录不用指定。-l 用来指定要链接的共享库，只需要指定库的名字就行了，如：

-lpthread，而不是 -llibpthread.so。看起来有点怪，这样做的原因是共享库通常带有版本号，

指定全文件名就意味着你要绑定到特定版本的共享库上，只指定名字则 在可以运行时通过

环境变量来选择要使用的共享库，这样能够给软件升级带来的方便



# 练习



双向链表

通用链表



对一个存放整数的双向链表，找出链表中的最大值。

对一个存放整数的双向链表，累加链表中所有整数。

对一个存放字符串的双向链表，把存放在其中的字符串转换成大写字母。(使用islower , toupper)'



双向链表支持多线程和单线程版本：

1. 支持多线程和单线程版本。对于多线程版本，由实现者(在链表)加锁/解锁，对于单线程版

本，其性能不受影响(或很小)。

2.  区分单线程版本和多线程版本时，不需要链接不同的库，或者要宏来控制，完全可以在运

行时切换。

3. 保持双向链表的通用性，不依赖于特定的平台。





